{"changed":true,"filter":false,"title":"send.php","tooltip":"/laravel/public/send.php","value":"<?php\n  // load configuration for database\n  require_once('config.inc.php'); \n  // connect to database\n  $mysqli = new mysqli($database_host, $database_user, $database_password, $database_name); \n\n  $content = $_POST[\"content\"];\n\n  // pickup cookies\n  $id= $_COOKIE[\"id\"];\n  $firstname= $_COOKIE[\"firstname\"];\n  $lastname= $_COOKIE[\"lastname\"];\n  if (!isset($_COOKIE[\"language\"])){\n    setcookie(\"language\",\"en\");\n  } // if language cookie\n  $language = $_COOKIE[\"language\"];\n  \n  $partnerID= $_COOKIE[\"partnerID\"];\n  $partnerfirstname= $_COOKIE[\"partnerfirstname\"];\n  $partnerlastname = $_COOKIE[\"partnerlastname\"];\n  $partnerlanguage = $_COOKIE[\"partnerlanguage\"];\n  echo($partnerlanguage);\n  $time = time();\n  setcookie(\"noclear\", \"whocares\", time()+1);\n  \n  \n  \n  //Translate the message\n  $translatedcontent = translate($language, $partnerlanguage, $content);\n  \n  \n  \n  $insert_row = $mysqli->query(\"INSERT INTO exchanges (senderID, receiverID, time, sender_content, receiver_content) \n\t\t\t\t    VALUES  ('$id', '$partnerID', '$time', '$content', '$translatedcontent')\");\n\t\t\t\t    \n\t function url_get_contents ($Url) {\n      if (!function_exists('curl_init')){ \n          die('CURL is not installed!');\n      }\n      $ch = curl_init();\n      curl_setopt($ch, CURLOPT_URL, $Url);\n      curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n      $output = curl_exec($ch);\n      curl_close($ch);\n      return $output;\n   }       \n  \n  \n   function translate($senderlang, $recieverlang, $message)\n   {\n     // Add the plus signs inside the message so it can be send via api request\n     $newstring = implode(\"+\", preg_split(\"/[\\s]+/\", $message));\n     echo \"<br>\";\n     echo $senderlang;\n     echo $recieverlang;\n     // Call the API\n     $url = \"http://itranslate4.eu/api/Translate?auth=785f2f42-eab1-461d-8a72-a1867112458a&src=\" . $senderlang . \"&trg=\" . $recieverlang . \"&dat=\" . $newstring;\n     // Get the contents of the URL\n     $contents = url_get_contents($url);\n     // Decode the returned JSON object and get the text\n     $json = json_decode($contents, true);\n     $translation = $json['dat'][0]['text'][0];\n     echo \"<br>\";\n     return $translation;\n     \n     \n   }\n      \n   //header(\"Location: https://web.cs.manchester.ac.uk/mbax4ab4/babeltalk/laravel/public/testinput.php\");\n  \n?>","undoManager":{"mark":99,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":61,"column":19},"end":{"row":61,"column":20},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":20},"end":{"row":61,"column":21},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":20},"end":{"row":61,"column":21},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":19},"end":{"row":61,"column":20},"action":"remove","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":19},"end":{"row":61,"column":20},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":20},"end":{"row":61,"column":21},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":21},"end":{"row":62,"column":0},"action":"insert","lines":["",""]},{"start":{"row":62,"column":0},"end":{"row":62,"column":5},"action":"insert","lines":["     "]}]}],[{"group":"doc","deltas":[{"start":{"row":62,"column":4},"end":{"row":62,"column":5},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":62,"column":2},"end":{"row":62,"column":4},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":62,"column":0},"end":{"row":62,"column":2},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":21},"end":{"row":62,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":60,"column":11},"end":{"row":60,"column":12},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":11},"end":{"row":59,"column":12},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":23},"end":{"row":60,"column":0},"action":"insert","lines":["",""]},{"start":{"row":60,"column":0},"end":{"row":60,"column":5},"action":"insert","lines":["     "]}]}],[{"group":"doc","deltas":[{"start":{"row":60,"column":5},"end":{"row":61,"column":0},"action":"insert","lines":["     $echo \"<br>\";",""]}]}],[{"group":"doc","deltas":[{"start":{"row":62,"column":25},"end":{"row":63,"column":0},"action":"insert","lines":["",""]},{"start":{"row":63,"column":0},"end":{"row":63,"column":5},"action":"insert","lines":["     "]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":5},"end":{"row":64,"column":0},"action":"insert","lines":["     $echo \"<br>\";",""]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":11},"end":{"row":57,"column":12},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":12},"end":{"row":57,"column":13},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":12},"end":{"row":57,"column":13},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":5},"end":{"row":57,"column":6},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":5},"end":{"row":58,"column":6},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":5},"end":{"row":59,"column":6},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":62,"column":5},"end":{"row":62,"column":6},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":5},"end":{"row":65,"column":6},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":0},"end":{"row":59,"column":0},"action":"remove","lines":["     echo \"<br>\";",""]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":5},"end":{"row":62,"column":23},"action":"remove","lines":["echo $senderlang;","          $echo \"<br>\";","","     echo $recieverlang;","          $echo \"<br>\";"]}]}],[{"group":"doc","deltas":[{"start":{"row":60,"column":0},"end":{"row":61,"column":0},"action":"remove","lines":["     echo $contents;",""]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":0},"end":{"row":60,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":5},"end":{"row":59,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":4},"end":{"row":58,"column":5},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":2},"end":{"row":58,"column":4},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":0},"end":{"row":58,"column":2},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":16},"end":{"row":58,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":16},"end":{"row":57,"column":21},"action":"remove","lines":["     "]},{"start":{"row":57,"column":16},"end":{"row":58,"column":0},"action":"insert","lines":["",""]},{"start":{"row":58,"column":0},"end":{"row":58,"column":5},"action":"insert","lines":["     "]}]}],[{"group":"doc","deltas":[{"start":{"row":67,"column":4},"end":{"row":67,"column":5},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":67,"column":3},"end":{"row":67,"column":4},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":0},"end":{"row":58,"column":0},"action":"remove","lines":["     echo $url; ",""]}]}],[{"group":"doc","deltas":[{"start":{"row":66,"column":3},"end":{"row":66,"column":4},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":66,"column":4},"end":{"row":66,"column":5},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":5},"end":{"row":52,"column":6},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":5},"end":{"row":52,"column":6},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":5},"end":{"row":52,"column":6},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":6},"end":{"row":52,"column":7},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":7},"end":{"row":52,"column":8},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":8},"end":{"row":52,"column":9},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":9},"end":{"row":52,"column":10},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":10},"end":{"row":52,"column":11},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":11},"end":{"row":52,"column":12},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":12},"end":{"row":52,"column":13},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":13},"end":{"row":52,"column":14},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":14},"end":{"row":52,"column":15},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":15},"end":{"row":52,"column":16},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":15},"end":{"row":52,"column":16},"action":"remove","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":15},"end":{"row":52,"column":16},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":10},"end":{"row":52,"column":16},"action":"remove","lines":["$sende"]},{"start":{"row":52,"column":10},"end":{"row":52,"column":21},"action":"insert","lines":["$senderlang"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":21},"end":{"row":52,"column":22},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":22},"end":{"row":53,"column":0},"action":"insert","lines":["",""]},{"start":{"row":53,"column":0},"end":{"row":53,"column":5},"action":"insert","lines":["     "]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":5},"end":{"row":53,"column":6},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":6},"end":{"row":53,"column":7},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":7},"end":{"row":53,"column":8},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":8},"end":{"row":53,"column":9},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":9},"end":{"row":53,"column":10},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":10},"end":{"row":53,"column":11},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":11},"end":{"row":53,"column":12},"action":"insert","lines":["e"]},{"start":{"row":53,"column":12},"end":{"row":53,"column":13},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":12},"end":{"row":53,"column":13},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":11},"end":{"row":53,"column":12},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":11},"end":{"row":53,"column":12},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":12},"end":{"row":53,"column":13},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":13},"end":{"row":53,"column":14},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":14},"end":{"row":53,"column":15},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":15},"end":{"row":53,"column":16},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":16},"end":{"row":53,"column":17},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":17},"end":{"row":53,"column":18},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":18},"end":{"row":53,"column":19},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":10},"end":{"row":53,"column":19},"action":"remove","lines":["$reciever"]},{"start":{"row":53,"column":10},"end":{"row":53,"column":23},"action":"insert","lines":["$recieverlang"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":23},"end":{"row":53,"column":24},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":23},"end":{"row":53,"column":24},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":53,"column":23},"end":{"row":53,"column":24},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":64},"end":{"row":52,"column":0},"action":"insert","lines":["",""]},{"start":{"row":52,"column":0},"end":{"row":52,"column":5},"action":"insert","lines":["     "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":5},"end":{"row":52,"column":6},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":6},"end":{"row":52,"column":7},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":7},"end":{"row":52,"column":8},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":8},"end":{"row":52,"column":9},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":9},"end":{"row":52,"column":10},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":10},"end":{"row":52,"column":12},"action":"insert","lines":["\"\""]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":11},"end":{"row":52,"column":12},"action":"insert","lines":["B"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":11},"end":{"row":52,"column":12},"action":"remove","lines":["B"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":10},"end":{"row":52,"column":12},"action":"remove","lines":["\"\""]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":10},"end":{"row":52,"column":11},"action":"insert","lines":["£"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":10},"end":{"row":52,"column":11},"action":"remove","lines":["£"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":10},"end":{"row":52,"column":12},"action":"insert","lines":["\"\""]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":11},"end":{"row":52,"column":12},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":11},"end":{"row":52,"column":12},"action":"remove","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":11},"end":{"row":52,"column":12},"action":"insert","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":12},"end":{"row":52,"column":13},"action":"insert","lines":["b"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":13},"end":{"row":52,"column":14},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":14},"end":{"row":52,"column":15},"action":"insert","lines":[">"]},{"start":{"row":52,"column":15},"end":{"row":52,"column":16},"action":"insert","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":15},"end":{"row":52,"column":16},"action":"remove","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":16},"end":{"row":52,"column":17},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":6},"end":{"row":12,"column":7},"action":"insert","lines":["!"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":12,"column":7},"end":{"row":12,"column":7},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1426848216174}